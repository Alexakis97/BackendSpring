<!DOCTYPE html>
<html lang="en">

<head>

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="">
<meta name="author" content="">

<title>Create an Announcement</title>

<!-- ---------------------------------- SUMMERNOTE LINKS START ----------------------------------  -->

<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
<link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-lite.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-lite.min.js"></script>

<!-- ---------------------------------- SUMMERNOTE LINKS END ----------------------------------  -->

<!-- Custom fonts for this template-->
<link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet"
	type="text/css">
<link
	href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
	rel="stylesheet">

<!-- Custom styles for this template-->
<link href="css/sb-admin-2.min.css" rel="stylesheet">





	<style>
		#map {
			width: 100%;
			height: 400px;
			background-color: grey;
		}
		</style>
		

</head>

<body id="page-top">
	<!-- Page Wrapper -->
	<div id="wrapper">
		
		<!-- Sidebar -->
		<ul
			class="navbar-nav sidebar sidebar-dark accordion"
			id="accordionSidebar" style="background-color: #c13b4d;">

			<!-- Sidebar - Brand -->
			<a
				class="sidebar-brand d-flex align-items-center justify-content-center"
				href="/dashboard ">
				<div class="sidebar-brand-icon rotate-n-15">
					<i class="fas fa-hands-helping"></i>
				</div>
				<div class="sidebar-brand-text mx-3">
					[[#{dashboard.left_side_menu_title1}]] <br> <sup
						th:text="${loggedinUser.roles}"></sup>

				</div>
			</a>

			<!-- Divider -->
			<hr class="sidebar-divider my-0">

			<div
				th:if="${loggedinUser.roles=='ADMIN'} or ${loggedinUser.roles=='STELEXOS'} or ${loggedinUser.roles=='TILEFONITIS'}">

				<!-- Nav Item - Dashboard -->
				<li class="nav-item"><a class="nav-link"
					href="/dashboard "> <i class="fas fa-fw fa-tachometer-alt"></i>
						<span>[[#{dashboard.left_side_menu_item1}]]</span></a></li>

			</div>

			<div
				th:if="${loggedinUser.roles=='ADMIN'} or ${loggedinUser.roles=='STELEXOS'}">
				<!-- Divider -->
				<hr class="sidebar-divider">

				<!-- Heading -->
				<div class="sidebar-heading">[[#{dashboard.left_side_menu_title2}]]</div>

				<li class="nav-item"><a class="nav-link" href="/charts "> <i
						class="fas fa-fw fa-chart-area"></i> <span>[[#{dashboard.left_side_menu_item2}]]</span></a></li>

			</div>

			<!-- Divider -->
			<hr class="sidebar-divider">

			<!-- Heading -->

			<div class="sidebar-heading">[[#{dashboard.left_side_menu_title3}]]</div>

			<div
				th:if="${loggedinUser.roles=='ADMIN'} or ${loggedinUser.roles=='STELEXOS'} or ${loggedinUser.roles=='TILEFONITIS'}">
				<!-- Nav Item - Tables -->
				<li class="nav-item"><a class="nav-link" href="/manageAeds">
					<i class="fas fa-heartbeat"></i> <span>
							[[#{dashboard.left_side_menu_item3}]]</span>
				</a></li>

			</div>


			<div
				th:if="${loggedinUser.roles=='ADMIN'} or ${loggedinUser.roles=='STELEXOS'}">

				<!-- Divider -->
				<hr class="sidebar-divider d-none d-md-block">

				<li class="nav-item"><a class="nav-link" href="/manageEvents">
					<i class="fas fa-bell"></i> <span>
							[[#{dashboard.left_side_menu_item4}]]</span>
				</a></li>

			</div>



			<div
				th:if="${loggedinUser.roles=='ADMIN'} or ${loggedinUser.roles=='STELEXOS'} or ${loggedinUser.roles=='TILEFONITIS'}">

				<hr class="sidebar-divider d-none d-md-block">
				<li class="nav-item"><a class="nav-link" href="/manageReports">
					<i class="fas fa-exclamation-triangle"></i></i> <span>
							[[#{dashboard.left_side_menu_item5}]]</span>
				</a></li>

			</div>

			<div
				th:if="${loggedinUser.roles=='ADMIN'} or ${loggedinUser.roles=='STELEXOS'}">

				<hr class="sidebar-divider d-none d-md-block">
				<li class="nav-item"><a class="nav-link"
					href="/manageAmbulance"> <i class="fas fa-ambulance"></i></i> <span>
							[[#{dashboard.left_side_menu_item6}]]</span>
				</a></li>

			</div>

			<div
				th:if="${loggedinUser.roles=='ADMIN'} or ${loggedinUser.roles=='STELEXOS'}">

				<hr class="sidebar-divider d-none d-md-block">
				<li class="nav-item"><a class="nav-link"
					href="/manageEmployees"> <i class="fas fa-user-tie"></i> <span>
							[[#{dashboard.left_side_menu_item7}]]</span>
				</a></li>

			</div>

			<div
				th:if="${loggedinUser.roles=='ADMIN'} or ${loggedinUser.roles=='STELEXOS'}">

				<hr class="sidebar-divider d-none d-md-block">
				
				<div class="sidebar-heading">[[#{dashboard.left_side_menu_title4}]]</div>

				<li class="nav-item active"><a class="nav-link"
					href="/communications"> <i class="fas fa-mail-bulk"></i> <span>
							[[#{dashboard.left_side_menu_item8}]]</span>
				</a></li>

			</div>

			<div
				th:if="${loggedinUser.roles=='ADMIN'} or ${loggedinUser.roles=='STELEXOS'}">

				<hr class="sidebar-divider d-none d-md-block">
				<li class="nav-item"><a class="nav-link"
					href="/chats"> <i class="fas fa-comment-dots"></i> <span>
							[[#{dashboard.left_side_menu_item9}]]</span>
				</a></li>

            </div>

			<!-- Sidebar Toggler (Sidebar) -->
			<div class="text-center d-none d-md-inline">
				<button class="rounded-circle border-0" id="sidebarToggle"></button>
			</div>

		</ul>
		<!-- End of Sidebar -->

		<!-- Content Wrapper -->
		<div id="content-wrapper" class="d-flex flex-column">

			<!-- Main Content -->
			<div id="content">

				<!-- Topbar -->
				<nav class="navbar navbar-expand navbar-light bg-white topbar mb-4 static-top shadow">

					<!-- Sidebar Toggle (Topbar) -->
					<button id="sidebarToggleTop"
						class="btn btn-link d-md-none rounded-circle mr-3">
						<i class="fa fa-bars"></i>
					</button>

					<!-- Topbar Search -->
					<form
						class="d-none d-sm-inline-block form-inline mr-auto ml-md-3 my-2 my-md-0 mw-100 navbar-search">
						<div class="input-group">
							<input type="text" class="form-control bg-light border-0 small"
								th:placeholder="#{topBar.search}"  aria-label="Search"
								aria-describedby="basic-addon2">
							<div class="input-group-append">
								<button class="btn btn-primary" type="button">
									<i class="fas fa-search fa-sm"></i>
								</button>
							</div>
						</div>
					</form>

					<!-- Topbar Navbar -->
					<ul class="navbar-nav ml-auto">

						<!-- Nav Item - Search Dropdown (Visible Only XS) -->
						<li class="nav-item dropdown no-arrow d-sm-none">
							<a class="nav-link dropdown-toggle" href="/#" id="searchDropdown"
								role="button" data-toggle="dropdown" aria-haspopup="true"
								aria-expanded="false">
								
								<i class="fas fa-search fa-fw"></i>
								
							</a> 
						
						
						<!-- Dropdown - Messages -->
							<div
								class="dropdown-menu dropdown-menu-right p-3 shadow animated--grow-in"
								aria-labelledby="searchDropdown">
								<form class="form-inline mr-auto w-100 navbar-search">
									<div class="input-group">
										<input type="text"
											class="form-control bg-light border-0 small"
											th:placeholder="#{topBar.search}"  aria-label="Search"
											aria-describedby="basic-addon2">
										<div class="input-group-append">
											<button class="btn btn-primary" type="button">
												<i class="fas fa-search fa-sm"></i>
											</button>
										</div>
									</div>
								</form>
							</div>
						</li>

						<!-- Nav Item - Alerts -->
						<li class="nav-item dropdown no-arrow mx-1">
						
							<a  class="nav-link dropdown-toggle"
							    href="/#"
							    id="alertsDropdown"
								role="button"
								data-toggle="dropdown" 
								aria-haspopup="true"
								aria-expanded="false">
								
								 <i class="fas fa-bell fa-fw" onclick="restartNotif();"></i>
								 
								  <!-- Counter - Alerts -->
								<span class="badge badge-danger badge-counter">3+</span>
							</a>
							
							 <!-- Dropdown - Alerts -->
							<div class="dropdown-list dropdown-menu dropdown-menu-right shadow animated--grow-in"
								 aria-labelledby="alertsDropdown">
								 
								<h6 class="dropdown-header">[[#{dashboard.notifications_title}]]</h6>
								
								<a class="dropdown-item d-flex align-items-center" href="/#">
											
											<div class="mr-3">
												<div class="icon-circle bg-primary">
													<i class="fas fa-file-alt text-white"></i>
												</div>
											</div>
											
											<div>
												<div class="small text-gray-500">December 12, 2019</div>
												<span class="font-weight-bold">A new monthly report is
													ready to download!</span>
											</div>
											
								</a>
								
								<a class="dropdown-item d-flex align-items-center" href="/#">
											
											<div class="mr-3">
												<div class="icon-circle bg-success">
													<i class="fas fa-donate text-white"></i>
												</div>
											</div>
											
											<div>
												<div class="small text-gray-500">December 7, 2019</div>
												$290.29 has been deposited into your account!
											</div>
								</a> 
								
								<a class="dropdown-item d-flex align-items-center" href="/#">
											<div class="mr-3">
												<div class="icon-circle bg-warning">
													<i class="fas fa-exclamation-triangle text-white"></i>
												</div>
											</div>
											<div>
												<div class="small text-gray-500">December 2, 2019</div>
												Spending Alert: We've noticed unusually high spending for your
												account.
											</div>
								</a>
								
								<a class="dropdown-item text-center small text-gray-500"
								   href="/manageEvents">
								   
								   [[#{dashboard.notifications_details}]]
								   
								</a>
							</div>
							
						</li>

						<!-- Nav Item - Messages -->
						<li class="nav-item dropdown no-arrow mx-1"><a
							class="nav-link dropdown-toggle" href="/#" id="messagesDropdown"
							role="button" data-toggle="dropdown" aria-haspopup="true"
							aria-expanded="false">
							
							 <i class="fas fa-envelope fa-fw"></i>
								
								<!-- Counter - Messages -->
								 <span class="badge badge-danger badge-counter">7</span>
						</a>
						
						 <!-- Dropdown - Messages -->
							<div
								class="dropdown-list dropdown-menu dropdown-menu-right shadow animated--grow-in"
								aria-labelledby="messagesDropdown">
								
								<h6 class="dropdown-header">[[#{dashboard.chat}]]</h6>
								
								<a class="dropdown-item d-flex align-items-center" href="/#">
								
									<div class="dropdown-list-image mr-3">
										<img class="rounded-circle"
											src="https://source.unsplash.com/fn_BT9fwg_E/60x60" alt="">
										<div class="status-indicator bg-success"></div>
									</div>
									
									<div class="font-weight-bold">
									
										<div class="text-truncate">Hi there! I am wondering if
											you can help me with a problem I've been having.</div>
											
										<div class="small text-gray-500">Emily Fowler · 58m</div>
										
									</div>
									
								</a> 
								<a class="dropdown-item d-flex align-items-center" href="/#">
								
									<div class="dropdown-list-image mr-3">
									
										<img class="rounded-circle"
											 src="https://source.unsplash.com/AU4VPcFN4LE/60x60" alt="">
											 
										<div class="status-indicator"></div>
									</div>
									
									<div>
									
										<div class="text-truncate">I have the photos that you
											ordered last month, how would you like them sent to you?</div>
										<div class="small text-gray-500">Jae Chun · 1d</div>
										
									</div>
									
								</a>
								
								<a class="dropdown-item d-flex align-items-center" href="/#">
									<div class="dropdown-list-image mr-3">
									
										<img class="rounded-circle"
											src="https://source.unsplash.com/CS2uCrpNzJY/60x60" alt="">
											
										<div class="status-indicator bg-warning"></div>
										
									</div>
									
									<div>
									
										<div class="text-truncate">Last month's report looks
											great, I am very happy with the progress so far, keep up the
											good work!</div>
											
										<div class="small text-gray-500">Morgan Alvarez · 2d</div>
										
									</div>
									
								</a> 
								
								<a class="dropdown-item d-flex align-items-center" href="/#">
								
									<div class="dropdown-list-image mr-3">
										<img class="rounded-circle"
											src="https://source.unsplash.com/Mv9hjnEUHR4/60x60" alt="">
										<div class="status-indicator bg-success"></div>
									</div>
									
									<div>
									
										<div class="text-truncate">Am I a good boy? The reason I
											ask is because someone told me that people say this to all
											dogs, even if they aren't good...</div>
											
										<div class="small text-gray-500">Chicken the Dog · 2w</div>
										
									</div>
									
								</a> 
								
								<a class="dropdown-item text-center small text-gray-500"
									href="/#">[[#{dashboard.chat_details}]]</a>
									
							</div>
							
						</li>

						<div class="topbar-divider d-none d-sm-block"></div>

						<!-- Nav Item - User Information -->
						<li class="nav-item dropdown no-arrow" role="presentation">
							<div class="nav-item dropdown no-arrow">
								<a class="dropdown-toggle nav-link" data-toggle="dropdown"
									aria-expanded="false" href="#"><span
									class="d-none d-lg-inline mr-2 text-gray-600 small"
									th:text="${loggedinUser.name} + ' '+${loggedinUser.surname} ">
								</span><img id="roundedImageProfile" th:src="@{'/profileImages/'+${loggedinUser.photo}}"
									class="border rounded-circle img-profile"></a>
								<div
									class="dropdown-menu shadow dropdown-menu-right animated--grow-in"
									role="menu">
									<a class="dropdown-item" role="presentation" href="/profile"><i
										class="fas fa-user fa-sm fa-fw mr-2 text-gray-400"></i>&nbsp;[[#{dashboard.profile_item1}]]</a>
									<div class="dropdown-divider"></div>
									<a href="/logout" class="dropdown-item" role="/logout"><i
										class="fas fa-sign-out-alt fa-sm fa-fw mr-2 text-gray-400"></i>&nbsp;[[#{dashboard.profile_item2}]]</a>
								</div>
							</div>
						</li>
						
						<li class="nav-item" style="width: auto; display: inline-block;"><a
							class="nav-link" th:href="@{?lang=en}"> <img
								th:src="@{/img/en.png}">
						</a></li>

						<li class="nav-item" style="width: auto; display: inline-block;"><a
							class="nav-link" th:href="@{?lang=el}"> <img
								th:src="@{/img/el.png}">
						</a></li>
					</ul>

				</nav>
				<!-- End of Topbar -->


				<!-- Begin Page Content -->
				<div class="container-fluid">



					<div class="row">




						<!-- Begin Page Content -->
						<div class="container-fluid">

							
							<div class="container">
								<button type="button"  class="btn btn-primary btn-sm" onclick="window.location.href='/communications'">Back to announcements</button>
								<br>
								<br>

								<form  >

										<div class="form-group">
											<label for="content">Content</label>
											<input  type="text" class="form-control" id="announcementTitle" aria-describedby="content" placeholder="Enter the title of your announcement">
											<small id="content" class="form-text text-muted">You will create an announcement.</small>
										</div>

										<div id="summernote"></div>

										<br>
										
										<button type="button" class="btn btn-secondary btn-lg">Send me an email preview</button>
										<br><br>
										<button id="submitAnnouncementBtn" type="button" class="btn btn-primary btn-lg btn-block">Submit</button>

								  </form>
								
							</div>

							<div id="summernoteValue" name="hide" style="display:none;">

							</div>

							

						</div>
						<!-- /.container-fluid -->

					</div>
				</div>


			</div>


			<!-- Footer -->
			<footer class="sticky-footer bg-white">
				<div class="container my-auto">
					<div class="copyright text-center my-auto">
						<span>Copyright &copy; LifeTime 2020</span>
					</div>
				</div>
			</footer>
			<!-- End of Footer -->

		</div>
		<!-- End of Content Wrapper -->

	</div>
	<!-- End of Page Wrapper -->

	<!-- Scroll to Top Button-->
	<a class="scroll-to-top rounded" href="#page-top"> <i
		class="fas fa-angle-up"></i>
	</a>

	<!-- Logout Modal-->
	<div class="modal fade" id="logoutModal" tabindex="-1" role="dialog"
		aria-labelledby="exampleModalLabel" aria-hidden="true">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="exampleModalLabel">Ready to Leave?</h5>
					<button class="close" type="button" data-dismiss="modal"
						aria-label="Close">
						<span aria-hidden="true">×</span>
					</button>
				</div>
				<div class="modal-body">Select "Logout" below if you are ready
					to end your current session.</div>
				<div class="modal-footer">
					<button class="btn btn-secondary" type="button"
						data-dismiss="modal">Cancel</button>
					<a class="btn btn-primary" href="/login">Logout</a>
				</div>
			</div>
		</div>
	</div>

	<script >

		$('#summernote').summernote({

			placeholder: 'Lifetime HSS will distribute your message to customers ...',
			tabsize: 2,
			height: 300
		});

	

		

		// // summernote.change
		$('#summernote').on('summernote.change', function(we, contents, $editable) {
			
			$("#summernoteValue").html(contents);
		});

		
		


		$(document).ready(function() {

			$("#submitAnnouncementBtn").click(function(){

				var title = document.getElementById("announcementTitle").value;

				var body = $('#summernoteValue').html();

				// console.log(body.length);

				var url_string = window.location.href;
				var url = new URL(url_string);
				var sendTo = url.searchParams.get("sendTo");

				var d = new Date();
				var dateTime = d.toString();

				console.log(dateTime);

				if(title.length == 0 ){

					
					$("#announcementTitle").attr('class', 'form-control is-invalid');

				}
				else{
					$("#announcementTitle").attr('class', 'form-control is-valid');
					postAnnouncement(title,body,sendTo,dateTime);
				}

				


			}); 

		});

		function postAnnouncement(title,body,sendTo,dateTime)
		{
			var obj = { 
				title: title, 
                body: body, 
                receiver: sendTo,
				dateCreated: dateTime,		
  	/*<![CDATA[*/
	  user : { 
		"userId":[[${loggedinUser.userId}]],
		         "name": "[[${loggedinUser.name}]]",
		         "surname": "[[${loggedinUser.surname}]]",
		         "email": "[[${loggedinUser.email}]]",
		         "password": "[[${loggedinUser.password}]]", 
		         "city": "[[${loggedinUser.city}]]",
		         "country": "[[${loggedinUser.country}]]",
		         "phone": "[[${loggedinUser.phone}]]",
		         "roles":"[[${loggedinUser.roles}]]",
		         "username": "[[${loggedinUser.username}]]",
		         "isActive": [[${loggedinUser.isActive}]],
		         "registrationDate": "[[${loggedinUser.registrationDate}]]",
		         "firebaseToken": "[[${loggedinUser.firebaseToken}]]",
		         "bloodType": "[[${loggedinUser.bloodType}]]",
		         "disease": "[[${loggedinUser.disease}]]",
		         "alergies": "[[${loggedinUser.alergies}]]",
		         "medicines": "[[${loggedinUser.medicines}]]",
		         "counterContacts":[[${loggedinUser.counterContacts}]],
		         "counterIncidents": [[${loggedinUser.counterIncidents}]],
				 "counterDirections": [[${loggedinUser.counterDirections}]],
				"photo":"[[${loggedinUser.photo}]]",
				"phoneNumber":"[[${loggedinUser.phoneNumber}]]",
				"periphery":"[[${loggedinUser.periphery}]]",
				"department":"[[${loggedinUser.department}]]",
				"municipality":"[[${loggedinUser.municipality}]]",
				"lat":[[${loggedinUser.lat}]],
				"lon":[[${loggedinUser.lon}]],
				"age":[[${loggedinUser.age}]],
				"gender":"[[${loggedinUser.gender}]]",
				 "clusterMunicipality":"[[${loggedinUser.clusterMunicipality}]]",
				 "dateOfBirth":"[[${loggedinUser.dateOfBirth}]]",
				 
				 hospital : { 
				   "hospital_id":[[${loggedinUser.hospital.hospital_id}]],
				   "name":"[[${loggedinUser.hospital.name}]]",
				   "lat":[[${loggedinUser.hospital.lat}]],
				   "lon":[[${loggedinUser.hospital.lon}]],
				   "address":"[[${loggedinUser.hospital.address}]]",
				   "phone":"[[${loggedinUser.hospital.phone}]]",
				   "clusterMunicipality":"[[${loggedinUser.hospital.clusterMunicipality}]]",
				   "eventProcessor":"[[${loggedinUser.hospital.eventProcessor}]]"
		       
				}
			}
	  };
	  /*]]>*/

	

	  		var myJSON = JSON.stringify(obj);

			var xmlhttp = new XMLHttpRequest();   // new HttpRequest instance 
                xmlhttp.open("POST", "/web/marketing/channel");
                xmlhttp.setRequestHeader("Content-Type", "application/json");
                var flag=true;
                xmlhttp.onreadystatechange = function() {
                    if (this.status == 200) {
                        
                        console.log("announcement was send");
                        
                   }
                    else
                        {
                        console.log("announcement was not send");
                        console.log("announcement failed status "+this.status);
                        }
                };
                xmlhttp.send(myJSON);
		}

		

		

		


	</script>

		 <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
		

	<!-- Bootstrap core JavaScript-->
	<script src="vendor/jquery/jquery.min.js"></script>
	<scrip src="vendor/bootstrap/js/bootstrap.bundle.min.js"></scrip>

	<!-- Core plugin JavaScript-->
	<scrip src="vendor/jquery-easing/jquery.easing.min.js"></scrip>

	<!-- Custom scripts for all pages-->
	<scrip src="js/sb-admin-2.min.js"></scrip>

	<!-- Page level plugins -->
	<scrip src="vendor/datatables/jquery.dataTables.min.js"></scrip>
	<scrip src="vendor/datatables/dataTables.bootstrap4.min.js"></scrip>

	<!-- Page level custom scripts -->
	<scrip src="js/demo/datatables-demo.js"></scrip>












</body>

</html>
